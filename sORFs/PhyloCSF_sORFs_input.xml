<tool id="PhyloCSF_sORFs_input" name="Step 4a: Create PhyloCSF input" version="1.0">
	
    <description>Creates sORF specific multiple alignments</description>
    
    <command interpreter="perl">
        #if $tisids.assembl == "all"
        ./PhyloCSF_sORFs_input.pl --sqliteDB "${sqlite_db}" --cores "${cores}" --tis_ids "${tisids.all}" --maf_root "${maf_root.fields.path}" --out_sqlite "${out_sqlite}"
        #else if $tisids.assembl == "specific"
        ./PhyloCSF_sORFs_input.pl --sqliteDB "${sqlite_db}" --cores "${cores}" --tis_ids "${tisids.specific}" --maf_root "${maf_root.fields.path}" --out_sqlite "${out_sqlite}"
        #end if
    </command>
    <inputs>
        <param name="sqlite_db" type="data" format="sqlite" size="30" label="Sqlite DB with information of steps 1, 2 and 3." help="The sqlite results database should contain output from the mapping (step 1), TIS calling (step 2) and sORF translation assembly (step 3)."/>
        <param name="maf_root" type="select"   label="Select the corresponding MAF root folder" >
            <options from_data_table="sORF_pipeline_maf" />
        </param>
        <param name="cores" type="integer" size="5" value="8" label="enter the number of cores to run the transcriptome mapping" help="Preferentially the number of chromosomes"/>
        <conditional name="tisids">
            <param name="assembl" type="select" label="Select TIS ids for PhyloCSF input">
                <option value="all">Perform assembly for all TIS-analysis ids</option>
                <option value="specific">Perform assembly for specific TIS-analysis ids</option>
            </param>
            <when value="specific">
                <param name="overview_in" type="data" size="30" format="tis" label="TIS overview file (Sqlite DB specific, see data number)" help="if your history does not contain the correct TIS overview file, first run the TIS overview tool selected Sqlite DB, see above."/>
                <param name="specific" type="select" display="checkboxes" label="TIS ids - Pick IDs for PhyloCSF input" multiple="true">
                    <options>
                        <filter type="data_meta" ref="overview_in" key="args" />
                    </options>
                </param>
            </when>
            <when value="all">
                <param name="all" type="hidden" value ="all" />
            </when>
        </conditional>
         </inputs>
    <outputs>
        <data format="sqlite" name="out_sqlite" label="SQLite database with mapping, TIS calling, sORF assembly and PhyloCSF MAF input(step1-2-3-4a)"/>
    </outputs>
    
    <help>
        
.. class:: infomark
        
**What it does**

This tool creates sORF specific multiple alignment data as input for PhyloCSF.

-----

.. class:: infomark

**Input**

An sqlite database holding experimental data from previous steps: i.e. 1.mapping, 2.TIS calling and 3. sORF Assembly

The number of cores to be used. Preferentialy the number of chromosomes.

The MAF root folder containing the species specific MAF files.

- You will need read access to the MAF root folder to be able to use this tool.
- The corresponding MAF files should be installed:

        fruitfly    ->  Multiple alignments of 14 insects with D. melanogaster (dm3, Apr. 2006, BDGP Release 5)
                        http://hgdownload.cse.ucsc.edu/goldenPath/dm3/multiz15way/README.txt
        mouse       ->  Multiple alignments of 59 vertebrate genomes with Mouse (mm10/GRCm38, Dec. 2011)
                        http://hgdownload.cse.ucsc.edu/goldenPath/mm10/multiz60way/README.txt
        human       ->  Multiple alignments of 99 vertebrate genomes with Human (hg19/GRCh38, Feb. 2009)
                        http://hgdownload.cse.ucsc.edu/goldenPath/hg19/multiz100way/README.txt

.. class:: infomark

**Output**

An sqlite database holding all experimental data resulting from the 1.mapping, 2.TIS calling, 3. sORF translation product assembly and 4a. sORF specific MAF sequences. After PhyloCSF input step an extra table will be added:

An extra TIS_id_sORFs_transcripts_maf table with all the sORF specific alignment sequences.


    </help>

</tool>